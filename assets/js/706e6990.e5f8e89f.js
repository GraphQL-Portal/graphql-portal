(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[39],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return u}});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),p=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=p(e.components);return i.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(n),u=a,h=m["".concat(s,".").concat(u)]||m[u]||d[u]||o;return n?i.createElement(h,r(r({ref:t},c),{},{components:n})):i.createElement(h,r({ref:t},c))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var p=2;p<o;p++)r[p]=n[p];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1082:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return r},contentTitle:function(){return l},metadata:function(){return s},toc:function(){return p},default:function(){return d}});var i=n(2122),a=n(9756),o=(n(7294),n(3905)),r={id:"api-definitions",title:"GraphQL API Definitions",sidebar_label:"GraphQL API Definitions"},l=void 0,s={unversionedId:"configuration/api-definitions",id:"configuration/api-definitions",isDocsHomePage:!1,title:"GraphQL API Definitions",description:"When not using Dashboard for configuration, the API Definitions are going to be read from the apis_path specified in",source:"@site/docs/configuration/api-definitions.md",sourceDirName:"configuration",slug:"/configuration/api-definitions",permalink:"/configuration/api-definitions",editUrl:"https://github.com/graphql-portal/graphql-portal/edit/main/docs-website/docs/configuration/api-definitions.md",version:"current",frontMatter:{id:"api-definitions",title:"GraphQL API Definitions",sidebar_label:"GraphQL API Definitions"},sidebar:"docs",previous:{title:"Gateway Config Options",permalink:"/configuration/gateway-options"},next:{title:"Data Source Configuration",permalink:"/configuration/data-source-configuration"}},p=[{value:"Configuration options",id:"configuration-options",children:[]},{value:"name",id:"name",children:[]},{value:"endpoint",id:"endpoint",children:[]},{value:"source_config_names",id:"source_config_names",children:[]},{value:"schema_polling_interval",id:"schema_polling_interval",children:[]},{value:"schema_updates_through_control_api",id:"schema_updates_through_control_api",children:[]},{value:"invalidate_cache_through_control_api",id:"invalidate_cache_through_control_api",children:[]},{value:"enable_ip_filtering",id:"enable_ip_filtering",children:[]},{value:"request_size_limit",id:"request_size_limit",children:[]},{value:"depth_limit",id:"depth_limit",children:[]},{value:"request_complexity_limit",id:"request_complexity_limit",children:[]},{value:"rate_limit",id:"rate_limit",children:[]},{value:"authentication",id:"authentication",children:[]}],c={toc:p};function d(e){var t=e.components,n=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"When ",(0,o.kt)("em",{parentName:"p"},"not")," using Dashboard for configuration, the API Definitions are going to be read from the ",(0,o.kt)("inlineCode",{parentName:"p"},"apis_path")," specified in\n",(0,o.kt)("inlineCode",{parentName:"p"},"gateway.json"),"."),(0,o.kt)("p",null,"Each file in that directory (either ",(0,o.kt)("inlineCode",{parentName:"p"},"json")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"yaml"),") represents a GraphQL API, which in turn may have 1 or more data sources."),(0,o.kt)("h2",{id:"configuration-options"},"Configuration options"),(0,o.kt)("p",null,"The only required options of the file are ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," (name of the API) and ",(0,o.kt)("inlineCode",{parentName:"p"},"endpoint")," (on which endpoint is it going to\nbe available):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="config/apidefs/my-first-api.json"',title:'"config/apidefs/my-first-api.json"'},'{\n  "name": "My First API",\n  "endpoint": "/my-first-api"\n}\n')),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"In fact, a GraphQL API can have 0 data sources but... that doesn't make a lot of sense in practice."))),(0,o.kt)("p",null,"In order to add the data-sources to our API we have to specify the ",(0,o.kt)("inlineCode",{parentName:"p"},"source_config_names")," option:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="config/apidefs/my-first-api.json"',title:'"config/apidefs/my-first-api.json"'},'{\n  "name": "My First API",\n  "endpoint": "/my-first-api",\n  "source_config_names": ["my-data-source.yaml"]\n}\n')),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Only the file name is required, the path is going to be resolved from the ",(0,o.kt)("inlineCode",{parentName:"p"},"sources_path")," option in ",(0,o.kt)("inlineCode",{parentName:"p"},"gateway.json"),"."))),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"/configuration/data-source-configuration"},"Read more about configuration of data sources"),"."),(0,o.kt)("p",null,"Below is the list of all available configuration options."),(0,o.kt)("h2",{id:"name"},"name"),(0,o.kt)("p",null,"Name of the API. It is mainly used for logging purposes."),(0,o.kt)("h2",{id:"endpoint"},"endpoint"),(0,o.kt)("p",null,'A unique endpoint of this API. Should start with "/".'),(0,o.kt)("h2",{id:"source_config_names"},"source_config_names"),(0,o.kt)("p",null,"Optional. Contains a list of filenames (with ",(0,o.kt)("inlineCode",{parentName:"p"},"json")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"yaml")," extension) of data-sources which should be included into\nthe API."),(0,o.kt)("h2",{id:"schema_polling_interval"},"schema_polling_interval"),(0,o.kt)("p",null,"Optional. Type of value \u2013 number. When set to a number bigger than 0, it will rebuild the GraphQL Schema of the API in the specified intervals\n(in milliseconds)."),(0,o.kt)("p",null,"This can be used to rebuild (in regular intervals) the federated schema for the underlying microservices. If during the\nrebuild phase at least one of the data-sources returned an error, the schema is not going to be rebuilt, and the old\nschema will continue to be served on the endpoint."),(0,o.kt)("h2",{id:"schema_updates_through_control_api"},"schema_updates_through_control_api"),(0,o.kt)("p",null,"Optional. Boolean. Defaults to ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),". When enabled, allows the rebuilding of the schema via control api."),(0,o.kt)("h2",{id:"invalidate_cache_through_control_api"},"invalidate_cache_through_control_api"),(0,o.kt)("p",null,"Optional. Boolean. Defaults to ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),". When enabled, allows the invalidating of the cache via control api."),(0,o.kt)("h2",{id:"enable_ip_filtering"},"enable_ip_filtering"),(0,o.kt)("p",null,"Optional. Boolean. Defaults to false. When enabled, switches on the IP Filtering middleware which is configured in a\nway of ",(0,o.kt)("em",{parentName:"p"},"allow_ips")," and ",(0,o.kt)("em",{parentName:"p"},"deny_ips")," lists."),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("inlineCode",{parentName:"p"},"allow_ips")," list has a priority over the ",(0,o.kt)("inlineCode",{parentName:"p"},"deny_ips")," list. It means, that if both lists are specified in the configuration,\nthen only ",(0,o.kt)("inlineCode",{parentName:"p"},"allow_ips")," values are going to be used."))),(0,o.kt)("p",null,"Examples of configuration:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Allow a single IP"',title:'"Allow',a:!0,single:!0,'IP"':!0},'{\n  "enable_ip_filtering": true,\n  "allow_ips": ["127.0.0.1"]\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Deny a range of IPs"',title:'"Deny',a:!0,range:!0,of:!0,'IPs"':!0},'{\n  "enable_ip_filtering": true,\n  "deny_ips": ["10.0.0.0/8"]\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Specify both allow and deny, allow will always take precedence and deny will be ignored"',title:'"Specify',both:!0,allow:!0,and:!0,"deny,":!0,will:!0,always:!0,take:!0,precedence:!0,deny:!0,be:!0,'ignored"':!0},'{\n  "enable_ip_filtering": true,\n  "allow_ips": ["10.0.0.1"],\n  "deny_ips": ["10.0.0.0/8"]\n}\n')),(0,o.kt)("h2",{id:"request_size_limit"},"request_size_limit"),(0,o.kt)("p",null,"Optional. This value specifies an HTTP Request size limit for a particular API Definition. Accepts numeric (in bytes) or string\nvalues. When string is used, the following abbreviations are used:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"b for bytes"),(0,o.kt)("li",{parentName:"ul"},"kb for kilobytes"),(0,o.kt)("li",{parentName:"ul"},"mb for megabytes"),(0,o.kt)("li",{parentName:"ul"},"gb for gigabytes"),(0,o.kt)("li",{parentName:"ul"},"tb for terabytes"),(0,o.kt)("li",{parentName:"ul"},"pb for petabytes.")),(0,o.kt)("h2",{id:"depth_limit"},"depth_limit"),(0,o.kt)("p",null,"Optional. Numeric value that specifies a maximum query depth limit for a given API Definition.\nDefault value is 10."),(0,o.kt)("h2",{id:"request_complexity_limit"},"request_complexity_limit"),(0,o.kt)("p",null,"Optional. Numeric value that specifies a maximum complexity for a request. Defaults to 1000."),(0,o.kt)("h2",{id:"rate_limit"},"rate_limit"),(0,o.kt)("p",null,"Optional. An object with two settings: ",(0,o.kt)("inlineCode",{parentName:"p"},"complexity"),", which specifies a total request complexity and ",(0,o.kt)("inlineCode",{parentName:"p"},"per"),", which stands\nfor a rolling time window in seconds."),(0,o.kt)("p",null,"Example of a configuration:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "rate_limit": {\n    "complexity": 10000,\n    "per": 3600\n  }\n}\n')),(0,o.kt)("h2",{id:"authentication"},"authentication"),(0,o.kt)("p",null,"Optional. An object with two fields:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"auth_header_name")," \u2013 name of the header from which the authentication token is going to be extracted;"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"auth_tokens")," \u2013 an array of strings that correspond to token names.")),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Due to security reasons we do not recommend specifying ",(0,o.kt)("inlineCode",{parentName:"p"},"auth_tokens")," directly in the configuration file but rather pass\nthem through the environment variables (separated by coma) by setting ",(0,o.kt)("inlineCode",{parentName:"p"},"auth_tokens")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"@@AUTH_TOKENS"),"."))))}d.isMDXComponent=!0}}]);